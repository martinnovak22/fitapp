import AsyncStorage from '@react-native-async-storage/async-storage';
import * as Localization from 'expo-localization';
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';

const resources = {
    en: {
        translation: {
            exercises: 'Exercises',
            workout: 'Workout',
            history: 'History',
            addExercise: 'Add Exercise',
            editExercise: 'Edit Exercise',
            exerciseDetails: 'Exercise Details',
            name: 'Name',
            muscleGroup: 'Muscle Group',
            exerciseType: 'Exercise Type',
            photo: 'Photo',
            saveChanges: 'Save Changes',
            createExercise: 'Create Exercise',
            delete: 'Delete',
            cancel: 'Cancel',
            update: 'Update',
            addSet: 'Add Set',
            inputSet: 'Input Set',
            editSet: 'Edit Set',
            weight: 'Weight',
            reps: 'Reps',
            distance: 'Distance',
            minutes: 'Minutes',
            seconds: 'Seconds',
            noExercises: 'No exercises found',
            addFirstExercise: 'Add your first exercise to get started',
            export: 'Export',
            import: 'Import',
            pyramidSet: 'Pyramid Set',
            exerciseTitle: 'Exercise',
            weightKg: 'Weight (kg)',
            distM: 'Dist (m)',
            noDropSets: 'No drop sets added yet',
            cleanState: 'Clean State',
            czech: 'Čeština',
            english: 'English',
            language: 'Language',
            avgTime: 'AVG TIME',
            perSession: 'Per session',
            weeklyActivity: 'Weekly Activity',
            activeSession: 'Active Session',
            resumeSession: 'Resume Session',
            startNewWorkout: 'Start New Workout',
            readyToCrush: 'Ready to crush your goals today?',
            noWorkoutsRecorded: 'No workouts recorded',
            sessions: 'Sessions',
            completed: 'Completed',
            incomplete: 'Incomplete',
            startedAt: 'Started at',
            loading: 'Loading...',
            notSpecified: 'Not specified',
            statsComingSoon: 'Stats coming soon',
            inProgress: 'In Progress',
            noWorkoutsYet: 'No workouts logged yet',
            addFirstWorkout: 'Start your first workout to build history.',
            edit: 'Edit',
            type: 'Type',
            deleteExerciseConfirm: 'Are you sure? This will delete all history for this exercise.',
            deleteSetTitle: 'Delete Set',
            deleteWorkoutTitle: 'Delete Workout',
            deleteExerciseTitle: 'Delete Exercise',
            progress: 'Progress',
            meters: 'Meters',
            time: 'Time',
            personalBest: 'Personal Best',
            average: 'Average',
            noHistoryData: 'No history data available',
            appearance: 'Appearance',
            lightMode: 'Light Mode',
            darkMode: 'Dark Mode',
            systemDefault: 'System Default',
            settings: 'Settings',
            error: 'Error',
            finishWorkout: 'Finish Workout',
            workoutFinished: 'Workout Finished',
            greatJob: 'Great job!',
            workoutDeleted: 'Workout Deleted',
            workoutRemoved: 'Workout removed from data storage.',
            setDeleted: 'Set Deleted',
            setRemoved: 'Set removed from workout.',
            exerciseDeleted: 'Exercise Deleted',
            exerciseRemoved: 'Exercise has been removed from your list.',
            selectExercise: 'Select Exercise',
            selectExerciseFirst: 'Please select an exercise first.',
            failedToSaveSet: 'Failed to save set. Please try again.',
            emptySetIgnored: 'Set Ignored',
            emptySetIgnoredMessage: 'An empty set cannot be added.',
            finish: 'Finish',
            permissionNeeded: 'Permission needed',
            allowCamera: 'Please allow camera access to take a photo.',
            required: 'Required',
            enterName: 'Please enter an exercise name.',
            failedToSaveExercise: 'Failed to save exercise.',
            deleteExerciseWarning: 'Are you sure? This will not delete past workout data but will remove it from the list.',
            exerciseUpdated: 'Exercise Updated',
            exerciseCreated: 'Exercise Created',
            updated: 'has been updated.',
            ready: 'is ready for your workouts.',
            trackingMode: 'Tracking Mode',
            timer: 'Timer',
            viewSummary: 'View Summary',
            viewHistory: 'View History',
            workoutSummary: 'Workout Summary',
            noSetsRecorded: 'No sets recorded',
            live: 'LIVE',
            changesSaved: 'Your changes have been saved.',
            newSetAdded: 'New set added to your workout.',
            removeSetConfirm: 'Are you sure you want to remove this set?',
            deleteWorkoutConfirm: 'Are you sure you want to delete this workout?',
            finishSessionConfirm: 'Are you sure you want to finish this session?',
            success: 'Success',
            csvSavedToDownloads: 'CSV saved to Downloads',
            sharingUnavailable: 'Sharing is not available on this device',
            exportFailed: 'Failed to export exercises',
            importSummary: 'Import finished: {{added}} added, {{merged}} merged, {{skipped}} skipped.',
            importSummaryNoSkipped: 'Import finished: {{added}} added, {{merged}} merged.',
            importFailed: 'Failed to import exercises. Make sure the CSV format is correct.',
            chooseExportAction: 'Choose what to do with the export file',
            shareFile: 'Share',
            saveToPhone: 'Save to phone',
            typeWeight: 'Weight',
            typeCardio: 'Cardio',
            typeBodyweight: 'Bodyweight',
            typeBodyweightTimer: 'Bodyweight (Timer)',
            placeholderName: 'e.g. Bench Press',
            placeholderMuscle: 'e.g. Chest',
            set_one: 'set',
            set_other: 'sets',
            close: 'Close',
            min: 'min',
            fullHistory: 'Full History',
            kg: 'kg',
            repsShort: 'reps',
            sets: 'sets',
            noData: 'No data',
            drop: 'Drop',
            session: 'Session',
            calendar: 'Calendar',
            newExercise: 'New Exercise',
            details: 'Details',
            oops: 'Oops!',
            screenNotFound: "This screen doesn't exist.",
            goHome: 'Go to home screen!',
        }
    },
    cs: {
        translation: {
            exercises: 'Cviky',
            workout: 'Trénink',
            history: 'Historie',
            addExercise: 'Přidat cvik',
            editExercise: 'Upravit cvik',
            exerciseDetails: 'Detaily cviku',
            name: 'Název',
            muscleGroup: 'Svalová skupina',
            exerciseType: 'Typ cviku',
            photo: 'Fotka',
            saveChanges: 'Uložit změny',
            createExercise: 'Vytvořit cvik',
            delete: 'Smazat',
            cancel: 'Zrušit',
            update: 'Upravit',
            addSet: 'Přidat sérii',
            inputSet: 'Zadat sérii',
            editSet: 'Upravit sérii',
            weight: 'Váha',
            reps: 'Opakování',
            distance: 'Vzdálenost',
            minutes: 'Minuty',
            seconds: 'Sekundy',
            noExercises: 'Žádné cviky nenalezeny',
            addFirstExercise: 'Přidejte svůj první cvik a začněte',
            export: 'Exportovat',
            import: 'Importovat',
            pyramidSet: 'Pyramidová série',
            exerciseTitle: 'Cvik',
            weightKg: 'Váha',
            distM: 'Vzdálenost (m)',
            noDropSets: 'Zatím žádné série',
            cleanState: 'Prázdný stav',
            czech: 'Čeština',
            english: 'Angličtina',
            language: 'Jazyk',
            avgTime: 'PRŮM. ČAS',
            perSession: 'Na trénink',
            weeklyActivity: 'Týdenní aktivita',
            activeSession: 'Aktivní trénink',
            resumeSession: 'Pokračovat',
            startNewWorkout: 'Začít trénink',
            readyToCrush: 'Jste připraveni makat?',
            noWorkoutsRecorded: 'Žádné tréninky',
            sessions: 'Tréninky',
            completed: 'Dokončeno',
            incomplete: 'Nedokončeno',
            startedAt: 'Začalo v',
            loading: 'Načítání...',
            notSpecified: 'Nespecifikováno',
            statsComingSoon: 'Statistiky již brzy',
            inProgress: 'Probíhá',
            noWorkoutsYet: 'Zatím žádné tréninky',
            addFirstWorkout: 'Spusťte svůj první trénink a začněte budovat historii.',
            edit: 'Upravit',
            type: 'Typ',
            deleteExerciseConfirm: 'Jste si jisti? Toto smaže veškerou historii pro tento cvik.',
            deleteSetTitle: 'Smazat sérii',
            deleteWorkoutTitle: 'Smazat trénink',
            deleteExerciseTitle: 'Smazat cvik',
            progress: 'Pokrok',
            meters: 'Metry',
            time: 'Čas',
            personalBest: 'Osobní rekord',
            average: 'Průměr',
            noHistoryData: 'Nejsou k dispozici žádná data historie',
            appearance: 'Vzhled',
            lightMode: 'Světlý režim',
            darkMode: 'Tmavý režim',
            systemDefault: 'Systém',
            settings: 'Nastavení',
            error: 'Chyba',
            finishWorkout: 'Ukončit trénink',
            workoutFinished: 'Trénink dokončen',
            greatJob: 'Skvělá práce!',
            workoutDeleted: 'Trénink smazán',
            workoutRemoved: 'Trénink byl odstraněn z úložiště.',
            setDeleted: 'Série smazána',
            setRemoved: 'Série byla odstraněna z tréninku.',
            exerciseDeleted: 'Cvik smazán',
            exerciseRemoved: 'Cvik byl odstraněn ze seznamu.',
            selectExercise: 'Vyberte cvik',
            selectExerciseFirst: 'Prosím, nejdříve vyberte cvik.',
            failedToSaveSet: 'Nepodařilo se uložit sérii. Zkuste to znovu.',
            emptySetIgnored: 'Série ignorována',
            emptySetIgnoredMessage: 'Prázdnou sérii nelze přidat.',
            finish: 'Dokončit',
            permissionNeeded: 'Vyžadováno oprávnění',
            allowCamera: 'Prosím, povolte přístup k fotoaparátu pro pořízení fotky.',
            required: 'Povinné',
            enterName: 'Zadejte prosím název cviku.',
            failedToSaveExercise: 'Nepodařilo se uložit cvik.',
            deleteExerciseWarning: 'Jste si jisti? Toto nesmaže minulá data tréninků, ale odstraní cvik ze seznamu.',
            exerciseUpdated: 'Cvik aktualizován',
            exerciseCreated: 'Cvik vytvořen',
            updated: 'byl aktualizován.',
            ready: 'je připraven k vašim tréninkům.',
            trackingMode: 'Režim sledování',
            timer: 'Časovač',
            viewSummary: 'Zobrazit shrnutí',
            viewHistory: 'Zobrazit historii',
            workoutSummary: 'Shrnutí tréninku',
            noSetsRecorded: 'Nejsou zaznamenány žádné série',
            live: 'ŽIVĚ',
            changesSaved: 'Změny byly uloženy.',
            newSetAdded: 'Nová série byla přidána do vašeho tréninku.',
            removeSetConfirm: 'Opravdu chcete odstranit tuto sérii?',
            deleteWorkoutConfirm: 'Opravdu chcete smazat tento trénink?',
            finishSessionConfirm: 'Opravdu chcete ukončit tento trénink?',
            success: 'Úspěch',
            csvSavedToDownloads: 'CSV bylo uloženo do složky Stahování',
            sharingUnavailable: 'Sdílení není na tomto zařízení k dispozici',
            exportFailed: 'Export cviků se nezdařil',
            importSummary: 'Import dokončen: {{added}} přidáno, {{merged}} sloučeno, {{skipped}} přeskočeno.',
            importSummaryNoSkipped: 'Import dokončen: {{added}} přidáno, {{merged}} sloučeno.',
            importFailed: 'Import cviků se nezdařil. Ujistěte se, že formát CSV je správný.',
            chooseExportAction: 'Vyberte, co chcete s exportovaným souborem udělat',
            shareFile: 'Sdílet',
            saveToPhone: 'Uložit do telefonu',
            typeWeight: 'S váhou',
            typeCardio: 'Kardio',
            typeBodyweight: 'Vlastní váha',
            typeBodyweightTimer: 'Vlastní váha (Časovač)',
            placeholderName: 'např. Bench Press',
            placeholderMuscle: 'např. Hrudník',
            set_one: 'série',
            set_other: 'sérií',
            close: 'Zavřít',
            min: 'min',
            fullHistory: 'Celá historie',
            kg: 'kg',
            repsShort: 'opak.',
            sets: 'sérií',
            noData: 'Žádná data',
            drop: 'Drop',
            session: 'Trénink',
            calendar: 'Kalendář',
            newExercise: 'Nový cvik',
            details: 'Detaily',
            oops: 'Jejda!',
            screenNotFound: 'Tato obrazovka neexistuje.',
            goHome: 'Přejít na hlavní obrazovku!',
        }
    }
};

const LANGUAGE_KEY = 'user-language';

const languageDetector = {
    type: 'languageDetector' as const,
    async: true,
    detect: async (callback: (lang: string) => void) => {
        const savedLanguage = await AsyncStorage.getItem(LANGUAGE_KEY);
        if (savedLanguage) {
            return callback(savedLanguage);
        }
        const locales = Localization.getLocales();
        const deviceLanguage = locales && locales.length > 0 ? locales[0].languageCode : 'en';
        callback(deviceLanguage || 'en');
    },
    init: () => { },
    cacheUserLanguage: async (language: string) => {
        await AsyncStorage.setItem(LANGUAGE_KEY, language);
    }
};

i18n
    .use(languageDetector)
    .use(initReactI18next)
    .init({
        resources,
        fallbackLng: 'en',
        interpolation: {
            escapeValue: false
        },
        react: {
            useSuspense: false
        }
    });

export default i18n;
